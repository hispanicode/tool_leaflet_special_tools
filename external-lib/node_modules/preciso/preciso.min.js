(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

const clean = require("./clean.js");

function absolute(n) {
  n = clean(n);
  if (n[0] === "-") return n.substring(1);
  else return n;
}

module.exports = absolute;
module.exports.default = absolute;

},{"./clean.js":5}],2:[function(require,module,exports){
"use strict";

const compare_positive = require("./compare_positive.js");
const clean = require("./clean.js");
const long_addition = require("./long_addition.js");
const long_subtraction = require("./long_subtraction.js");

function add(a, b) {
  a = clean(a);
  b = clean(b);

  const apos = a[0] !== "-";
  const bpos = b[0] !== "-";

  if (apos && bpos) {
    return long_addition(a, b);
  } else if (!apos && !bpos) {
    return "-" + long_addition(a.substring(1), b.substring(1));
  } else if (!apos && bpos) {
    a = a.substring(1);
    switch (compare_positive(a, b)) {
      case "=":
        return "0";
      case "<":
        return long_subtraction(b, a);
      case ">":
        return "-" + long_subtraction(a, b);
    }
  } else if (apos && !bpos) {
    b = b.substring(1);
    switch (compare_positive(a, b)) {
      case "=":
        return "0";
      case "<":
        return "-" + long_subtraction(b, a);
      case ">":
        return long_subtraction(a, b);
    }
  }
}

module.exports = add;
module.exports.default = add;

},{"./clean.js":5,"./compare_positive.js":7,"./long_addition.js":36,"./long_subtraction.js":39}],3:[function(require,module,exports){
"use strict";

const clean = require("./clean.js");
const compare_positive = require("./compare_positive.js");
const factorial = require("./factorial.js");
const long_addition = require("./long_addition.js");
const long_subtraction = require("./long_subtraction.js");
const long_division = require("./long_division.js");
const multiply_range = require("./multiply_range.js");

function binomial_coefficient(n, k) {
  n = clean(n);
  k = clean(k);

  switch (compare_positive(n, k)) {
    case "=":
      return "1";
    case ">": {
      const diff = long_subtraction(n, k);
      const numerator = multiply_range(long_addition(k, "1"), n);
      const denominator = factorial(diff);
      return long_division(numerator, denominator);
    }
    case "<": {
      throw new Error("[binominal_coefficient] unsupported");
    }
  }
}

module.exports = binomial_coefficient;
module.exports.default = binomial_coefficient;

},{"./clean.js":5,"./compare_positive.js":7,"./factorial.js":21,"./long_addition.js":36,"./long_division.js":37,"./long_subtraction.js":39,"./multiply_range.js":45}],4:[function(require,module,exports){
"use strict";

const absolute = require("./absolute.js");
const clean = require("./clean.js");
const long_addition = require("./long_addition.js");
const sign = require("./sign.js");

function ceil(n) {
  n = clean(n);

  const idot = n.indexOf(".");

  // if not a decimal number
  // return the original number
  if (idot === -1) return n;

  const nsign = sign(n);

  // convert n to an absolute integer
  n = absolute(n).split(".")[0];

  if (nsign === "+") {
    // like 1.5 => 1 => 2
    return long_addition(n, "1");
  } else if (nsign === "-") {
    // like -1.5 => -1
    if (n === "0" || n === "") {
      return "0";
    } else {
      return "-" + n;
    }
  }
}

module.exports = ceil;
module.exports.default = ceil;

},{"./absolute.js":1,"./clean.js":5,"./long_addition.js":36,"./sign.js":61}],5:[function(require,module,exports){
"use strict";

const expand = require("./expand.js");

module.exports = function clean(n) {
  // remove + from beginning
  if (n[0] === "+") n = n.substring(1);

  n = expand(n);

  // remove extra zero in front
  // 03938.123 => 3938.123
  n = n.replace(/^0+(?=\d)/, "");

  // remove extra zero at end
  if (n.includes(".")) n = n.replace(/\.?0+$/, "");

  // should improve this, so it identifies zero earlier
  if (n === "") n = "0";

  if (n === "-0") n = "0";

  return n;
};

},{"./expand.js":20}],6:[function(require,module,exports){
"use strict";

const clean = require("./clean.js");
const compare_positive = require("./compare_positive.js");

function compare(a, b) {
  a = clean(a);
  b = clean(b);

  const a_is_positive = a[0] !== "-";
  const b_is_positive = b[0] !== "-";

  if (a_is_positive) {
    if (b_is_positive) {
      return compare_positive(a, b);
    } else {
      return ">";
    }
  } else if (b_is_positive) {
    return "<";
  } else {
    return compare_positive(b.substring(1), a.substring(1));
  }
}

module.exports = compare;
module.exports.default = compare;

},{"./clean.js":5,"./compare_positive.js":7}],7:[function(require,module,exports){
"use strict";

// given:
//  - a and b are positive numbers
//  - a and b have been cleaned (i.e. no + or leading zeros)
function compare_positive(a, b) {
  const alen = a.length;
  const blen = b.length;

  const aidx = a.indexOf(".");
  const bidx = b.indexOf(".");

  // basically where would the dot be
  // if we add a dot at the end of integers
  // like 123.
  const a_adjusted_dot_index = aidx === -1 ? alen : aidx;
  const b_adjusted_dot_index = bidx === -1 ? blen : bidx;

  // how much you need to shift the second number
  // to line up the decimal with the first
  //        0.12345
  //    12345.0

  const offset = a_adjusted_dot_index - b_adjusted_dot_index;

  let left = Math.max(a_adjusted_dot_index, b_adjusted_dot_index);

  let right = Math.max(alen - a_adjusted_dot_index, blen - b_adjusted_dot_index);

  let aoffset = offset < 0 ? -1 * offset : 0;
  let boffset = offset <= 0 ? 0 : offset;

  let imax = left + 1 + right - 1; // -1 for zero-index

  let i = 0;
  while (i < imax) {
    const ai = i - aoffset;
    const achar = ai === a_adjusted_dot_index ? "." : a[ai] || "0";
    const bi = i - boffset;
    const bchar = bi === b_adjusted_dot_index ? "." : b[bi] || "0";
    if (achar !== bchar) {
      if (achar > bchar) return ">";
      else if (achar < bchar) return "<";
    }
    i++;
  }

  return "=";
}

module.exports = compare_positive;
module.exports.default = compare_positive;

},{}],8:[function(require,module,exports){
"use strict";

const { MAX_SAFE_INTEGER } = require("./max_safe_integer.js");
const { MAX_SAFE_INTEGER_LENGTH } = require("./max_safe_integer_length.js");
const { PI } = require("./pi_100.js");

module.exports = {
  MAX_SAFE_INTEGER,
  MAX_SAFE_INTEGER_LENGTH,
  PI
};

},{"./max_safe_integer.js":9,"./max_safe_integer_length.js":10,"./pi_100.js":11}],9:[function(require,module,exports){
"use strict";

// Internet Explorer doesn't support Number.MAX_SAFE_INTEGER
// so we just define the constant ourselves
const MAX_SAFE_INTEGER = 9007199254740991;

module.exports = { MAX_SAFE_INTEGER };

},{}],10:[function(require,module,exports){
"use strict";

const { MAX_SAFE_INTEGER } = require("./max_safe_integer.js")

// the greatest number of digits an integer can have
// and be guaranteed to be stored safely as a floating point.
// subtract 1 because MAX_SAFE_INTEGER isn't all 9's
const MAX_SAFE_INTEGER_LENGTH = MAX_SAFE_INTEGER.toString().length - 1;

module.exports = { MAX_SAFE_INTEGER_LENGTH };

},{"./max_safe_integer.js":9}],11:[function(require,module,exports){
module.exports = {
  PI_100: '3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679'
};

},{}],12:[function(require,module,exports){
"use strict";

const add = require("./add.js");
const is_zero = require("./is_zero.js");
const square = require("./square.js");
const multiply_rational = require("./multiply_rational.js");
const divide = require("./divide.js");

/**
 * @name cosine_radians
 * @private
 * @param {String} n
 * @returns {String} cosine of n
 */
function cosine_radians(n, { steps = 100, max_decimal_digits = 100 } = {}) {
  if (is_zero(n)) return "0";

  let sign = "-";
  let result = "1";
  let imax = steps;
  let nsquare = square(n);
  let numerator = "1";
  let denominator = "1";
  let f1;
  let f2 = "0";
  for (let i = 0; i < imax; i++) {
    f1 = add(f2, "1");
    f2 = add(f1, "1");

    // same as increasing the power by 2
    numerator = multiply_rational([numerator, nsquare], { max_decimal_digits });
    denominator = multiply_rational([denominator, f1, f2], { max_decimal_digits });
    const diff = divide(numerator, denominator, { max_decimal_digits });

    result = add(result, sign + diff);

    sign = sign === "-" ? "+" : "-";
  }
  return result;
}

module.exports = cosine_radians;
module.exports.default = cosine_radians;

},{"./add.js":2,"./divide.js":17,"./is_zero.js":35,"./multiply_rational.js":46,"./square.js":67}],13:[function(require,module,exports){
"use strict";

const clean = require("./clean.js");

function count_decimal_digits(n) {
  n = clean(n);

  const i = n.indexOf(".");

  // n is an integer
  if (i === -1) return "0";

  return (n.length - i - 1).toString();
}

module.exports = count_decimal_digits;
module.exports.default = count_decimal_digits;

},{"./clean.js":5}],14:[function(require,module,exports){
"use strict";

const absolute = require("./absolute.js");
const clean = require("./clean.js");

function count_integer_digits(n) {
  n = absolute(clean(n));

  const i = n.indexOf(".");

  return (i === -1 ? n.length : i).toString();
}

module.exports = count_integer_digits;
module.exports.default = count_integer_digits;

},{"./absolute.js":1,"./clean.js":5}],15:[function(require,module,exports){
"use strict";

const pow = require("./pow.js");

/**
 *
 * @param {String} base - numerical string
 * @returns {String} cube (base * base * base) as a numerical string
 */
function cube(base, options) {
  return pow(base, "3", options);
}

module.exports = cube;
module.exports.default = cube;

},{"./pow.js":50}],16:[function(require,module,exports){
"use strict";

const root = require("./root.js");

function cube_root(radicand, options) {
  return root(radicand, "3", options);
}

module.exports = cube_root;
module.exports.default = cube_root;

},{"./root.js":56}],17:[function(require,module,exports){
"use strict";

const absolute = require("./absolute.js");
const clean = require("./clean.js");
const long_division = require("./long_division.js");

/**
 * @name divide
 * @param {String} dividend
 * @param {String} divisor
 * @param {Object} options
 * @param {Number} options.max_decimal_digits
 * @param {Boolean} options.ellipsis
 * @returns {String} - quotient
 */
function divide(dividend, divisor, options) {
  dividend = clean(dividend);
  divisor = clean(divisor);

  if (divisor === "0") throw new Error("[preciso] division by zero");

  // sometimes dividend can be cleaned to ""
  if (dividend === "" || dividend === "0") return "0";

  const dividend_is_positive = dividend[0] !== "-";
  const divisor_is_positive = divisor[0] !== "-";

  const out_sign = dividend_is_positive !== divisor_is_positive ? "-" : "";

  if (!dividend_is_positive) dividend = absolute(dividend);
  if (!divisor_is_positive) divisor = absolute(divisor);

  return out_sign + long_division(dividend, divisor, options);
}

module.exports = divide;
module.exports.default = divide;

},{"./absolute.js":1,"./clean.js":5,"./long_division.js":37}],18:[function(require,module,exports){
"use strict";

const add = require("./add.js");
const divide = require("./divide.js");

function eulers_number({ max_decimal_digits = 100, steps = 100 } = {}) {
  let sum = "1";
  let step = "1";
  for (let i = 1; i < steps; i++) {
    step = divide(step, i.toString(), { max_decimal_digits });
    sum = add(sum, step);
  }

  return sum;
}

module.exports = eulers_number;
module.exports.default = eulers_number;

},{"./add.js":2,"./divide.js":17}],19:[function(require,module,exports){
"use strict";

const clean = require("./clean.js");
const is_negative_infinity = require("./is_negative_infinity.js");
const is_positive_infinity = require("./is_positive_infinity.js");
const is_zero = require("./is_zero.js");
const eulers_number = require("./eulers_number.js");
const pow = require("./pow.js");

function exp(power, { max_decimal_digits = 100 } = {}) {
  const e = eulers_number({ max_decimal_digits: 2 * max_decimal_digits });

  if (is_negative_infinity(power)) return "0";
  if (is_positive_infinity(power)) return "Infinity";
  if (is_zero(power)) return "1";

  power = clean(power);

  return pow(e, power, { max_decimal_digits });
}

module.exports = exp;
module.exports.default = exp;

},{"./clean.js":5,"./eulers_number.js":18,"./is_negative_infinity.js":32,"./is_positive_infinity.js":34,"./is_zero.js":35,"./pow.js":50}],20:[function(require,module,exports){
"use strict";

// convert exponential notation to normal string
// not optimized yet and no support for big numbers
function expand(n) {
  // remove + from beginning
  if (n[0] === "+") n = n.substring(1);

  const sign = n[0] === "-" ? "-" : "";
  if (sign === "-") n = n.substring(1);

  const index_of_e = n.indexOf("e");

  // number not in exponential notation
  if (index_of_e === -1) return sign + n;

  let index_of_dot = n.indexOf(".");

  // if number doesn't include a period dot
  // then just assume it at the end
  // such that 3e4 has index of dot at 1
  if (index_of_dot === -1) index_of_dot = index_of_e;

  const shift = Number(n.substring(index_of_e + 1));

  // remove old decimal place
  const base = n.substring(0, index_of_e).replace(".", "");

  // normalize shift to start of the string at index zero
  const normshift = index_of_dot + shift;

  const baselen = base.length;

  if (normshift >= baselen) {
    const zct = normshift - baselen;
    let result = base;
    for (let i = 0; i < zct; i++) result += "0";
    return sign + result;
  } else if (normshift < 0) {
    // need to add zeros in decimal places
    let result = "0.";
    for (let i = 0; i > normshift; i--) result += "0";
    result += base;
    return sign + result;
  } else {
    // shifting within the base
    return sign + base.substring(0, normshift) + "." + base.substring(normshift);
  }
}

module.exports = expand;
module.exports.default = expand;

},{}],21:[function(require,module,exports){
"use strict";

const multiply_range = require("./multiply_range.js");

function factorial(n) {
  if (n === "0") return "1";
  return multiply_range("1", n);
}

module.exports = factorial;
module.exports.default = factorial;

},{"./multiply_range.js":45}],22:[function(require,module,exports){
"use strict";

const absolute = require("./absolute.js");
const clean = require("./clean.js");
const long_addition = require("./long_addition.js");
const sign = require("./sign.js");

function floor(n) {
  n = clean(n);

  const idot = n.indexOf(".");

  // if not a decimal number
  // return the original number
  if (idot === -1) return n;

  const nsign = sign(n);

  // convert n to an absolute integer
  n = absolute(n).split(".")[0];

  if (nsign === "+") {
    // like 1.5 => 1
    return n;
  } else if (nsign === "-") {
    if (n === "0" || n === "") {
      // like -0.5
      return "-1";
    } else {
      // like -1.5 => -2
      return "-" + long_addition(n, "1");
    }
  }
}

module.exports = floor;
module.exports.default = floor;

},{"./absolute.js":1,"./clean.js":5,"./long_addition.js":36,"./sign.js":61}],23:[function(require,module,exports){
"use strict";

const count_decimal_digits = require("./count_decimal_digits.js");

/**
 * @private
 * @param {String} n - decimal string
 * @returns {Array.<string>} n - fraction like ["123", "100"] (meaning 123/100)
 */
function fraction(n) {
  const decimal_digits = count_decimal_digits(n);

  const numerator = n.replace(/\./g, "").replace(/^0/, "");
  const denominator = 1 + "0".repeat(decimal_digits);

  return [numerator, denominator];
}

module.exports = fraction;
module.exports.default = fraction;

},{"./count_decimal_digits.js":13}],24:[function(require,module,exports){
"use strict";

const square = require("./square.js");
const square_root = require("./square_root.js");
const sum = require("./sum.js");

function hypotenuse() {
  const args = Array.from(arguments);
  const options = typeof args[args.length - 1] === "object" ? args[args.length - 1] : undefined;
  const nums = Array.isArray(args[0]) ? args[0] : options ? args.slice(0, args.length - 1) : args;
  const squares = nums.map(n => square(n));
  return square_root(sum(squares), options);
}

module.exports = hypotenuse;
module.exports.default = hypotenuse;

},{"./square.js":67,"./square_root.js":68,"./sum.js":70}],25:[function(require,module,exports){
"use strict";

const clean = require("./clean.js");
const is_integer = require("./is_integer.js");

function is_even(n) {
  n = clean(n);

  if (!is_integer(n)) throw new Error("can't call is_even on decimal");

  return ["0", "2", "4", "6", "8"].includes(n.charAt(n.length - 1));
}

module.exports = is_even;
module.exports.default = is_even;

},{"./clean.js":5,"./is_integer.js":30}],26:[function(require,module,exports){
"use strict";

function is_factorial(n) {
  return !!n.match(/^\d+!$/i);
}

module.exports = is_factorial;
module.exports.default = is_factorial;

},{}],27:[function(require,module,exports){
"use strict";

/**
 * @param {String} n
 * @returns {Boolean} result
 */
function is_fraction(n) {
  return n.includes("/");
}

module.exports = is_fraction;
module.exports.default = is_fraction;

},{}],28:[function(require,module,exports){
"use strict";

function is_imaginary(n) {
  return n.includes("i");
}

module.exports = is_imaginary;
module.exports.default = is_imaginary;

},{}],29:[function(require,module,exports){
"use strict";

function is_infinity(n) {
  return !!n.match(/^(|-|\+)inf(inity)?$/i);
}

module.exports = is_infinity;
module.exports.default = is_infinity;

},{}],30:[function(require,module,exports){
"use strict";

const clean = require("./clean.js");
const is_infinity = require("./is_infinity.js");

function is_integer(n) {
  if (is_infinity(n)) return false;
  n = clean(n);
  return !n.includes(".") && !n.includes("/");
}

module.exports = is_integer;
module.exports.default = is_integer;

},{"./clean.js":5,"./is_infinity.js":29}],31:[function(require,module,exports){
"use strict";

const clean = require("./clean");

function is_negative(n) {
  n = clean(n);
  return n[0] === "-";
}

module.exports = is_negative;
module.exports.default = is_negative;

},{"./clean":5}],32:[function(require,module,exports){
"use strict";

function is_negative_infinity(n) {
  return !!n.match(/^-inf(inity)?$/i);
}

module.exports = is_negative_infinity;
module.exports.default = is_negative_infinity;

},{}],33:[function(require,module,exports){
const clean = require("./clean.js");
const is_integer = require("./is_integer.js");

function is_odd(n) {
  n = clean(n);

  if (!is_integer(n)) throw new Error("can't call is_odd on decimal");

  return ["1", "3", "5", "7", "9"].includes(n.charAt(n.length - 1));
}

module.exports = is_odd;
module.exports.default = is_odd;

},{"./clean.js":5,"./is_integer.js":30}],34:[function(require,module,exports){
"use strict";

function is_positive_infinity(n) {
  return !!n.match(/^\+?inf(inity)?$/i);
}

module.exports = is_positive_infinity;
module.exports.default = is_positive_infinity;

},{}],35:[function(require,module,exports){
"use strict";

function is_zero(n) {
  return /^[-+]?0(\.0+)?(e[\.\d]+)?$/.test(n);
}

module.exports = is_zero;
module.exports.default = is_zero;

},{}],36:[function(require,module,exports){
"use strict";

const { MAX_SAFE_INTEGER_LENGTH } = require("./constants/max_safe_integer_length.js");

// assumes both numbers are positive numbers
function long_addition(a, b) {
  const alen = a.length;
  const blen = b.length;

  const aidx = a.indexOf(".");
  const bidx = b.indexOf(".");

  // basically where would the dot be
  // if we add a dot at the end of integers
  // like 123.
  const a_adjusted_dot_index = aidx === -1 ? alen : aidx;
  const b_adjusted_dot_index = bidx === -1 ? blen : bidx;

  // just use floating point arithmetic for small integers
  if (aidx === -1 && bidx === -1 && alen < MAX_SAFE_INTEGER_LENGTH && blen < MAX_SAFE_INTEGER_LENGTH) {
    return (Number(a) + Number(b)).toFixed();
  }

  // how much you need to shift the second number
  // to line up the decimal with the first
  //        0.12345
  //    12345.0

  const offset = a_adjusted_dot_index - b_adjusted_dot_index;

  let left = Math.max(a_adjusted_dot_index, b_adjusted_dot_index);

  let right = Math.max(alen - a_adjusted_dot_index - 1, blen - b_adjusted_dot_index - 1);

  let aoffset = offset < 0 ? -1 * offset : 0;
  let boffset = offset <= 0 ? 0 : offset;

  let imax = left + 1 + right - 1; // -1 for zero-index

  let result = "";

  let carried = 0;

  // to the right of the period
  //        0.12345
  //    12345.0
  let i = imax;
  if (right > 0) {
    while (i > imax - right) {
      const achar = a[i - aoffset] || "0";
      const bchar = b[i - boffset] || "0";
      let n = Number(achar) + Number(bchar) + carried;
      if (n >= 10) {
        n -= 10;
        carried = 1;
      } else {
        carried = 0;
      }
      if (result !== "" || n !== 0) {
        result = n + result;
      }
      i--;
    }
    if (result) result = "." + result;
    i--; // substract 1 for dot
  }

  if (left > 0) {
    while (i >= 0) {
      const achar = a[i - aoffset] || "0";
      const bchar = b[i - boffset] || "0";
      let n = Number(achar) + Number(bchar) + carried;
      if (n >= 10) {
        n -= 10;
        carried = 1;
      } else {
        carried = 0;
      }
      result = n + result;
      i--;
    }
  }

  if (carried === 1) {
    result = carried + result;
  }

  if (result[0] === ".") result = "0" + result;

  return result;
}

module.exports = long_addition;
module.exports.default = long_addition;

},{"./constants/max_safe_integer_length.js":10}],37:[function(require,module,exports){
"use strict";

const compare_positive = require("./compare_positive.js");
const add = require("./add.js");
const subtract = require("./subtract.js");
const round_last_decimal = require("./round_last_decimal.js");

// given dividend and divisor are positive numberical strings
function long_division(dividend, divisor, { format = "string", max_decimal_digits = 100, ellipsis = false } = {}) {
  // remove unnecessary starting zeros
  // ex: 0.5 => .5
  if (dividend[0] === "0") dividend = dividend.substring(1);
  if (divisor[0] === "0") divisor = divisor.substring(1);

  const dividend_index_of_dot = dividend.indexOf(".");
  const divisor_index_of_dot = divisor.indexOf(".");

  const adjusted_dividend_index_of_dot = dividend_index_of_dot === -1 ? dividend.length : dividend_index_of_dot;
  const divisor_num_decimal_places = divisor_index_of_dot === -1 ? 0 : divisor.length - 1 - divisor_index_of_dot;

  // whether the result has a repeating decimal
  // e.g. 1/3 is repeating as in "0.333..."
  let repeating = false;

  // remove decimals
  dividend = dividend.replace(/\./, "");
  divisor = divisor.replace(/\./, "");

  const dividend_length = dividend.length;

  let current = "";
  let quotient = "";
  let comparison;
  let offset = -1 * divisor_num_decimal_places;
  let skip = 0;
  for (let i = 0; i < dividend_length; i++) {
    const char = dividend[i];

    current += char;

    comparison = compare_positive(current, divisor);

    if (comparison === ">") {
      // same as const times = Math.floor(current / divisor);
      // but without floating point problems
      let times = 1;
      let product = add(divisor, divisor);
      let passed_product = divisor;
      while (compare_positive(product, current) !== ">") {
        times++;
        passed_product = product;
        product = add(product, divisor);
      }
      times = times.toString();

      if (quotient !== "") {
        for (let i = times.length; i <= skip; i++) quotient += "0";
      }
      quotient += times; // string concatentation

      current = subtract(current, passed_product);

      skip = 0;
    } else if (comparison === "<") {
      if (quotient === "") {
        offset++;
      }
      skip++;

      // outside greater than inside
      continue;
    } else if (comparison === "=") {
      if (quotient !== "") {
        for (let i = 0; i < skip; i++) quotient += "0";
      }
      quotient += "1";
      current = "0";
      skip = 0;
    }
  }

  if (current.match(/^0+$/g)) {
    if (comparison === "<") {
      quotient += current.substring(0, current.length - 1);
    }
  } else {
    const previous = {};

    // keep dividing until we have an answer
    // figure out current place of decimal number
    const idot = adjusted_dividend_index_of_dot - offset;
    const qlen = quotient.length;
    // add 1 extra for rounding purposes
    const imax = idot - qlen + max_decimal_digits + 1;

    // reset skip if just "" so far because don't want to count 0 in 0.
    if (quotient === "") {
      skip = 0;
    }

    for (let i = 0; i < imax; i++) {
      current += "0";
      if (ellipsis) {
        if (current in previous) {
          previous[current]++;
          if (previous[current] > 3) {
            quotient += "...";
            repeating = true;
            break;
          }
        } else {
          previous[current] = 1;
        }
      }
      const comparison = compare_positive(current, divisor);

      if (comparison === ">") {
        // inside greater than outside

        // how many times the divisor goes into the current
        let times = 1;
        let product = add(divisor, divisor);
        let passed_product = divisor;
        while (compare_positive(product, current) !== ">") {
          times++;
          passed_product = product;
          product = add(product, divisor);
        }

        times = times.toString();

        // pad left zeros
        for (let i = times.length; i <= skip; i++) quotient += "0";
        quotient += times; // string concatentation
        current = subtract(current, passed_product);

        if (current === "0") {
          break;
        }

        skip = 0;
      } else if (comparison === "<") {
        // outside greater than inside
        skip++;
        continue;
      } else if (comparison === "=") {
        // fill in previous with zeros
        for (let i = 0; i < skip; i++) quotient += "0";
        quotient += "1";
        skip = 0;
        break;
      }
    }
  }

  // reinsert decimal place

  const idot = adjusted_dividend_index_of_dot - offset;
  const qlen = quotient.length;

  let num_decimals;

  if (idot === qlen) {
    // integer number so don't do anything
    num_decimals = 0;
  } else if (idot < 0) {
    quotient = "0." + "0".repeat(Math.abs(idot)) + quotient;
    num_decimals = qlen - idot; // idot is negative, so adding
  } else if (idot > qlen) {
    // add more zeros to integer
    for (let i = qlen; i < idot; i++) quotient += "0";
    num_decimals = 0;
  } else if (idot < qlen) {
    quotient = quotient.substring(0, idot) + "." + quotient.substring(idot);
    num_decimals = qlen - idot;
  } else if (idot === 0) {
    quotient = "0." + quotient;
    num_decimals = qlen;
  }

  // remove zeros from front
  // 03938.123 => 3938.123
  quotient = quotient.replace(/^0+/, "");

  // remove extra zeros from the end
  quotient = quotient.replace(/\.\d+0+$/, "");

  const extra_decimals = num_decimals - max_decimal_digits;

  // round if necessary
  if (!repeating) {
    if (extra_decimals > 0) {
      quotient = round_last_decimal(quotient.substring(0, quotient.length - extra_decimals + 1));
    }
  }

  if (quotient[0] === ".") quotient = "0" + quotient;

  if (format === "object") {
    return { quotient, extra_decimals };
  } else {
    return quotient;
  }
}

module.exports = long_division;
module.exports.default = long_division;

},{"./add.js":2,"./compare_positive.js":7,"./round_last_decimal.js":59,"./subtract.js":69}],38:[function(require,module,exports){
"use strict";

const { MAX_SAFE_INTEGER_LENGTH } = require("./constants/max_safe_integer_length.js");

const CHUNK_SIZE = 15;

/**
 *
 * @param {String} a - numerical string larger or equal to b
 * @param {String} b - numerical string smaller or equal to a
 * @returns {String} product - result of multiplying a with b
 */

function long_multiplication(a, b) {
  if (a === "0" || b === "0") return "0";

  const top_index_of_dot = a.indexOf(".");
  const bottom_index_of_dot = b.indexOf(".");

  const a_num_integer_places = top_index_of_dot === -1 ? a.length : top_index_of_dot;
  const b_num_integer_places = bottom_index_of_dot === -1 ? b.length : bottom_index_of_dot;
  const max_total_num_integer_places = a_num_integer_places + b_num_integer_places;

  const a_num_decimal_places = top_index_of_dot === -1 ? 0 : a.length - 1 - top_index_of_dot;
  const b_num_decimal_places = bottom_index_of_dot === -1 ? 0 : b.length - 1 - bottom_index_of_dot;

  const out_num_decimal_places = a_num_decimal_places + b_num_decimal_places;

  if (out_num_decimal_places === 0 && max_total_num_integer_places < MAX_SAFE_INTEGER_LENGTH) {
    return (Number(a) * Number(b)).toFixed(0);
  }

  // remove decimals
  const aint = a.replace(".", "");
  const bint = b.replace(".", "");

  const alen = aint.length;
  const blen = bint.length;

  const chunks = [];
  let i = alen;
  while (i >= 0) {
    const end = i;
    const start = (i -= CHUNK_SIZE);
    const str = aint.substring(start, end);
    chunks.push([Number(str), str.length]);
  }

  const partial_products = [];
  const partials = [];

  // for each number in multiplier
  for (let i = 0, ireverse = blen - 1; ireverse >= 0; ireverse--, i++) {
    const bstr = bint[ireverse];

    const bnum = Number(bstr);

    let carried = 0;
    let partial = "";
    const ichunklast = chunks.length - 1;
    chunks.forEach(([chunk, chunklen], c) => {
      const subpartial = carried + bnum * chunk;
      let subpartstr = subpartial.toString();
      const subpartcharlen = subpartstr.length;
      if (subpartcharlen > chunklen && c !== ichunklast) {
        const islice = -1 * chunklen;
        partial = subpartstr.slice(islice) + partial;
        carried = Number(subpartstr.slice(0, islice));
      } else {
        const imax = chunklen - subpartcharlen;
        for (let i = 0; i < imax; i++) {
          subpartstr = "0" + subpartstr;
        }
        carried = 0;
        partial = subpartstr + partial;
      }
    });

    // add number of zeros at end
    partial += "0".repeat(i);

    partial_products.push(partial);

    partials.push([Array.from(partial).map(char => Number(char)), partial.length]);
  }

  // back to front, iterate through columns
  // and add partial products together
  const num_partials = partial_products.length;

  const number_of_columns = partials[partials.length - 1][1] + num_partials;

  let result = "";
  let carried = 0;
  for (let icol = 0; icol < number_of_columns; icol++) {
    let sum = carried;
    const pmax = Math.min(icol, num_partials - 1);
    for (let p = 0; p <= pmax; p++) {
      const [pnums, plen] = partials[p];
      const i = plen - 1 - icol;
      if (i >= 0) {
        sum += pnums[i];
      }
    }

    if (sum >= 10) {
      sum = sum.toString();
      result = sum[sum.length - 1] + result;
      carried = Number(sum.slice(0, -1));
    } else {
      result = sum + result;
      carried = 0;
    }
  }

  // add decimal back in
  if (out_num_decimal_places === 0) {
    // integer
    // remove extra zeros
    result = result.replace(/^0+/, "");
  } else {
    // decimal number
    const idot = result.length - out_num_decimal_places;

    result = result.substring(0, idot) + "." + result.substring(idot);

    // remove zeros from front
    result = result.replace(/^0+/, "");

    // remove extra zeros from the end
    result = result.replace(/\.?0+$/, "");

    if (result[0] === ".") result = "0" + result;
  }

  return result;
}

module.exports = long_multiplication;
module.exports.default = long_multiplication;

},{"./constants/max_safe_integer_length.js":10}],39:[function(require,module,exports){
"use strict";

// const lookup = {};
// const vals = [undefined, 0, 1, 2, 3, 4, 5, 6, 8, 9];
// vals.forEach(top => {
//   lookup[top] = {};
//   vals.forEach(bottom => {
//     lookup[top][bottom] = (top || 0) - (bottom || 0);
//   })
// });

const { MAX_SAFE_INTEGER_LENGTH } = require("./constants/max_safe_integer_length.js");

// assumes (1) both a and b are positive numbers
// and (2) a is larger than b
function long_subtraction(a, b) {
  const alen = a.length;
  const blen = b.length;

  const aidx = a.indexOf(".");
  const bidx = b.indexOf(".");

  // basically where would the dot be
  // if we add a dot at the end of integers
  // like 123.
  const a_adjusted_dot_index = aidx === -1 ? alen : aidx;
  const b_adjusted_dot_index = bidx === -1 ? blen : bidx;
  // console.log({a_adjusted_dot_index, b_adjusted_dot_index});

  // how much you need to shift the second number
  // to line up the decimal with the first
  //        0.12345
  //    12345.0

  // just use floating point arithmetic for small integers
  if (aidx === -1 && bidx === -1 && alen < MAX_SAFE_INTEGER_LENGTH && blen < MAX_SAFE_INTEGER_LENGTH) {
    return (Number(a) - Number(b)).toFixed();
  }

  const offset = a_adjusted_dot_index - b_adjusted_dot_index;
  // console.log("offset:", offset);

  let left = Math.max(a_adjusted_dot_index, b_adjusted_dot_index);
  // console.log("left:", left);

  let right = Math.max(alen - a_adjusted_dot_index - 1, blen - b_adjusted_dot_index - 1);
  // console.log("right:", right);

  let aoffset = offset < 0 ? -1 * offset : 0;
  let boffset = offset <= 0 ? 0 : offset;
  // console.log({aoffset, boffset});

  let imax = left + 1 + right - 1; // -1 for zero-index
  // console.log({imax});

  let result = "";

  // number of borrowings
  let borrowed = 0;

  // to the right of the period
  //  100.5  6  7
  //    2.2  9  3
  //        (-3 + 10)  4
  let i = imax;
  if (right > 0) {
    while (i > imax - right) {
      // console.log("\n\n", {i});
      let top = a[i - aoffset] || "0";
      let bottom = b[i - boffset] || "0";

      // console.log("pre borrowing", {top, bottom});
      top -= borrowed;
      borrowed = 0;

      // console.log("after borrowing", {top, bottom});
      let n = top - bottom;

      // console.log({n});
      if (n < 0) {
        while (n < 0) {
          borrowed++;
          n += 10;
        }
      } else if (borrowed) {
        borrowed--;
      }
      // console.log({n});
      if (result !== "" || n !== 0) {
        result = n + result;
      }
      i--;
    }
    if (result !== "") {
      result = "." + result;
    }
    i--; // substract 1 for dot
  }

  // console.log({result});

  if (left > 0) {
    while (i > 0) {
      // console.log("\n\n", {i});
      let top = a[i - aoffset] || "0";
      let bottom = b[i - boffset] || "0";

      // console.log("pre borrowing", {top, bottom});
      top -= borrowed;
      borrowed = 0;

      // console.log("after borrowing", {top, bottom});
      let n = top - bottom;

      // console.log({n});
      if (n < 0) {
        while (n < 0) {
          borrowed++;
          n += 10;
        }
      } else if (borrowed) {
        borrowed--;
      }
      // console.log({n});
      result = n + result;
      i--;
    }

    // console.log({borrowed});
    // special rule for last one
    const achar = a[0 - aoffset] || "0";
    const bchar = b[0 - boffset] || "0";
    let n = Number(achar) - (borrowed > 0 ? 1 : 0) - Number(bchar);
    if (n !== 0) {
      result = n + result;
    }

    // remove any zeros in front like in 0123
    result = result.replace(/^0+/, "");
  }

  // if decimal number add zero
  if (result[0] === ".") result = "0" + result;

  return result;
}

module.exports = long_subtraction;
module.exports.default = long_subtraction;

},{"./constants/max_safe_integer_length.js":10}],40:[function(require,module,exports){
"use strict";

const clean = require("./clean.js");
const compare = require("./compare.js");

function max(nums) {
  // called like max(n1, n2, n3...)
  if (typeof nums === "string") nums = Array.prototype.slice.call(arguments);
  let result = clean(nums[0]);
  const len = nums.length;
  for (let i = 1; i < len; i++) {
    const n = nums[i];
    if (compare(n, result) === ">") {
      result = n;
    }
  }
  return result;
}

module.exports = max;
module.exports.default = max;

},{"./clean.js":5,"./compare.js":6}],41:[function(require,module,exports){
"use strict";

const add = require("./add.js");
const divide = require("./divide.js");

function mean(nums, options) {
  let count = 0;
  let total = "0";
  for (let num of nums) {
    count++;
    total = add(total, num);
  }
  return divide(total, count.toString(), options);
}

module.exports = mean;
module.exports.default = mean;

},{"./add.js":2,"./divide.js":17}],42:[function(require,module,exports){
"use strict";

const clean = require("./clean.js");
const compare = require("./compare.js");

function min(nums) {
  // called like min(n1, n2, n3...)
  if (typeof nums === "string") nums = Array.prototype.slice.call(arguments);
  let result = clean(nums[0]);
  const len = nums.length;
  for (let i = 1; i < len; i++) {
    const n = nums[i];
    if (compare(n, result) === "<") {
      result = n;
    }
  }
  return result;
}

module.exports = min;
module.exports.default = min;

},{"./clean.js":5,"./compare.js":6}],43:[function(require,module,exports){
"use strict";

const multiply_array = require("./multiply_array.js");

function multiply() {
  const args = Array.from(arguments);
  const options = typeof args[args.length - 1] === "object" ? args[args.length - 1] : undefined;
  const nums = Array.isArray(args[0]) ? args[0] : options ? args.slice(0, args.length - 1) : args;
  return multiply_array(nums, options);
}

module.exports = multiply;
module.exports.default = multiply;

},{"./multiply_array.js":44}],44:[function(require,module,exports){
"use strict";

const is_imaginary = require("./is_imaginary.js");
const is_odd = require("./is_odd.js");
const multiply_rational = require("./multiply_rational.js");

/**
 * @name multiply_array
 * @private
 * @description Multiply an array of numbers together
 * @param {Array.<String>} nums - array of numerical strings
 * @returns {String} product as a numerical string
 */
function multiply_array(nums, { max_decimal_digits } = {}) {
  const imaginary = is_odd(nums.filter(n => is_imaginary(n)).length.toString());
  let product = multiply_rational(
    nums.map(n => n.replace(/i$/, "")),
    { max_decimal_digits }
  );
  if (imaginary) product += "i";
  return product;
}

module.exports = multiply_array;
module.exports.default = multiply_array;

},{"./is_imaginary.js":28,"./is_odd.js":33,"./multiply_rational.js":46}],45:[function(require,module,exports){
"use strict";

const compare_positive = require("./compare_positive.js");
const is_zero = require("./is_zero.js");
const long_multiplication = require("./long_multiplication.js");
const long_addition = require("./long_addition.js");

function multiply_range(min, max, step = "1") {
  if (is_zero(min)) return "0";
  let product = min;
  let n = min;
  while (compare_positive(n, max) === "<") {
    n = long_addition(n, step);
    product = long_multiplication(product, n);
  }

  return product;
}

module.exports = multiply_range;
module.exports.default = multiply_range;

},{"./compare_positive.js":7,"./is_zero.js":35,"./long_addition.js":36,"./long_multiplication.js":38}],46:[function(require,module,exports){
"use strict";

const absolute = require("./absolute.js");
const clean = require("./clean.js");
const compare_positive = require("./compare_positive.js");
const long_multiplication = require("./long_multiplication.js");
const round = require("./round.js");

/**
 * @name multiply
 * @returns {String} product
 */
function multiply_rational(nums, { max_decimal_digits } = {}) {
  let product = clean(nums[0]);
  let product_absolute = absolute(product);
  let product_sign = product[0] === "-" ? "-" : "";

  const imax = nums.length;
  for (let i = 1; i < imax; i++) {
    const current = clean(nums[i]);
    const current_sign = current[0] === "-" ? "-" : "";
    const current_absolute = absolute(current);
    product_sign = product_sign !== current_sign ? "-" : "";

    const comparison = compare_positive(product_absolute, current_absolute);

    product_absolute = comparison === "<" ? long_multiplication(current_absolute, product_absolute) : long_multiplication(product_absolute, current_absolute);

    product = product_sign + product_absolute;
  }
  if (typeof max_decimal_digits === "number") product = round(product, { digits: max_decimal_digits });
  return product;
}

module.exports = multiply_rational;
module.exports.default = multiply_rational;

},{"./absolute.js":1,"./clean.js":5,"./compare_positive.js":7,"./long_multiplication.js":38,"./round.js":58}],47:[function(require,module,exports){
"use strict";

const add = require("./add.js");
const long_addition = require("./long_addition.js");
const divide = require("./divide.js");
const multiply_rational = require("./multiply_rational.js");

// calculate PI using Nilakantha Series
function nilakantha(steps = 100, { divide_options } = {}) {
  let sign = "+";
  let pi = "3";
  let a = "2";
  let b = "3";
  let c = "4";
  for (let i = 1; i < steps; i++) {
    const divisor = multiply_rational([a, b, c]);

    const part = sign + divide("4", divisor, divide_options);

    pi = add(pi, part);

    // flip sign
    sign = sign === "-" ? "+" : "-";

    a = c;
    b = long_addition(c, "1");
    c = long_addition(b, "1");
  }
  return pi;
}

module.exports = nilakantha;
module.exports.default = nilakantha;

},{"./add.js":2,"./divide.js":17,"./long_addition.js":36,"./multiply_rational.js":46}],48:[function(require,module,exports){
"use strict";

const add = require("./add.js");
const divide = require("./divide.js");
const multiply_rational = require("./multiply_rational.js");
const round = require("./round.js");
const subtract = require("./subtract.js");
const square = require("./square.js");

function ols(points, options) {
  const number_of_points = points.length;
  let sum_of_x = "0";
  let sum_of_x_squares = "0";
  let sum_of_y = "0";
  let sum_of_y_squares = "0";

  if (number_of_points === 0) throw Error("[preciso] zero points passed to linear_regression");

  for (let i = 0; i < number_of_points; i++) {
    const [x, y] = points[i];
    sum_of_x = add(sum_of_x, x);
    sum_of_x_squares = add(sum_of_x_squares, square(x));
    sum_of_y = add(sum_of_y, y);
    sum_of_y_squares = add(sum_of_y_squares, square(y));
  }

  const number_of_points_as_string = number_of_points.toString();
  const x_mean = divide(sum_of_x, number_of_points_as_string);
  const y_mean = divide(sum_of_y, number_of_points_as_string);

  // second pass to calculate errors
  let sum_of_errors = "0";
  let sum_of_residual_squares = "0";
  for (let i = 0; i < number_of_points; i++) {
    const [x, y] = points[i];

    const x_error = subtract(x, x_mean);
    const y_error = subtract(y, y_mean);
    const xy_error = multiply_rational([x_error, y_error]);
    sum_of_errors = add(sum_of_errors, xy_error);

    const x_error_square = square(x_error);
    sum_of_residual_squares = add(sum_of_residual_squares, x_error_square);
  }

  // y = m * x + b
  let m = divide(sum_of_errors, sum_of_residual_squares);
  let b = subtract(y_mean, multiply_rational(m, x_mean));

  if (options && typeof options.max_decimal_digits === "number") {
    m = round(m, { digits: options.max_decimal_digits });
    b = round(b, { digits: options.max_decimal_digits });
  }

  return { m, b };
}

module.exports = ols;
module.exports.default = ols;

},{"./add.js":2,"./divide.js":17,"./multiply_rational.js":46,"./round.js":58,"./square.js":67,"./subtract.js":69}],49:[function(require,module,exports){
"use strict";

function parse_fraction(n) {
  return n.split("/");
}

module.exports = parse_fraction;
module.exports.default = parse_fraction;

},{}],50:[function(require,module,exports){
"use strict";

const absolute = require("./absolute.js");
const clean = require("./clean.js");
const divide = require("./divide.js");
const fraction = require("./fraction.js");
const is_integer = require("./is_integer");
const is_imaginary = require("./is_imaginary.js");
const is_odd = require("./is_odd.js");
const is_zero = require("./is_zero.js");
const multiply = require("./multiply.js");
const pow_positive = require("./pow_positive.js");
const reciprocal = require("./reciprocal.js");
const root = require("./root.js");
const round = require("./round.js");
const sign = require("./sign");
const simplify_fraction = require("./simplify_fraction.js");

function pow(
  base,
  exponent,
  {
    zero_to_the_power_of_zero = "1",
    // passed to divide then long_division
    ellipsis = false,
    imaginary = true,
    max_decimal_digits = 100,
    fraction: use_fraction = false
  } = {}
) {
  base = clean(base);
  exponent = clean(exponent);

  const base_is_imaginary = imaginary && is_imaginary(base);
  if (base_is_imaginary) base = base.replace(/i$/, "");

  const base_is_zero = is_zero(base);
  const exponent_is_zero = is_zero(exponent);

  if (base_is_zero && exponent_is_zero) {
    // https://en.wikipedia.org/wiki/Zero_to_the_power_of_zero
    return zero_to_the_power_of_zero;
  }

  if (exponent_is_zero) {
    return "1";
  }

  // const sign_of_base = sign(base);
  const sign_of_exponent = sign(exponent);

  if (base_is_zero) {
    if (sign_of_exponent === "+") {
      return "0";
    } else if (sign_of_exponent === "-") {
      return "Infinity";
    }
  }

  const exponent_is_integer = is_integer(exponent);

  if (sign_of_exponent === "+" && exponent_is_integer) {
    let product = pow_positive(base, exponent);
    if (typeof max_decimal_digits === "number") {
      product = round(product, { digits: max_decimal_digits });
    }
    if (base_is_imaginary && is_odd(exponent)) product += "i";
    return product;
  }

  if (sign_of_exponent === "-" && exponent_is_integer) {
    // e.g. pow(7, -2) => 1 / pow(7, 2)
    const numerator = "1";
    const denominator = pow_positive(base, absolute(exponent));
    return divide(numerator, denominator, { ellipsis, max_decimal_digits });
  }

  if (!exponent_is_integer) {
    exponent = absolute(exponent);

    let [numerator, denominator] = exponent.includes("/") ? exponent.split("/") : fraction(exponent);

    [numerator, denominator] = simplify_fraction(numerator, denominator);

    // base could be an integer or decimal
    // denominator is an integer
    let inner = root(base, denominator, { imaginary });

    let result = multiply(numerator, inner);
    // console.log({ sign_of_exponent, base, exponent, numerator, denominator, inner, result, max_decimal_digits })

    if (typeof max_decimal_digits === "number") result = round(result, { digits: max_decimal_digits });
    // console.log("rounded:", result);

    if (sign_of_exponent === "-") {
      result = reciprocal(result, { fraction: use_fraction, max_decimal_digits });
    }

    return result;
  }
}

module.exports = pow;
module.exports.default = pow;

},{"./absolute.js":1,"./clean.js":5,"./divide.js":17,"./fraction.js":23,"./is_imaginary.js":28,"./is_integer":30,"./is_odd.js":33,"./is_zero.js":35,"./multiply.js":43,"./pow_positive.js":51,"./reciprocal.js":54,"./root.js":56,"./round.js":58,"./sign":61,"./simplify_fraction.js":63}],51:[function(require,module,exports){
"use strict";

const multiply_rational = require("./multiply_rational.js");

// assuming:
// - base and exponent are clean
// - exponent is a positive integer
function pow_positive(base, exponent) {
  const imax = Number(exponent);
  let product = base;
  for (let i = 1; i < imax; i++) {
    product = multiply_rational([product, base]);
  }
  return product;
}

module.exports = pow_positive;
module.exports.default = pow_positive;

},{"./multiply_rational.js":46}],52:[function(require,module,exports){
"use strict";

/* global define */
const absolute = require("./absolute.js");
const add = require("./add.js");
const binomial_coefficient = require("./binomial_coefficient.js");
const ceil = require("./ceil.js");
const clean = require("./clean.js");
const compare = require("./compare.js");
const compare_positive = require("./compare_positive.js");
const constants = require("./constants/index.js");
const cosine_radians = require("./cosine_radians.js");
const count_decimal_digits = require("./count_decimal_digits.js");
const count_integer_digits = require("./count_integer_digits.js");
const cube = require("./cube.js");
const cube_root = require("./cube_root.js");
const divide = require("./divide.js");
const eulers_number = require("./eulers_number.js");
const exp = require("./exp.js");
const expand = require("./expand.js");
const factorial = require("./factorial.js");
const floor = require("./floor.js");
const fraction = require("./fraction.js");
// const gregory_leibniz = require("./gregory_leibniz.js");
const hypotenuse = require("./hypotenuse.js");
const is_factorial = require("./is_factorial.js");
const is_infinity = require("./is_infinity.js");
const is_integer = require("./is_integer.js");
const is_negative_infinity = require("./is_negative_infinity.js");
const is_positive_infinity = require("./is_positive_infinity.js");
const is_zero = require("./is_zero.js");
const long_addition = require("./long_addition.js");
const long_division = require("./long_division.js");
const long_multiplication = require("./long_multiplication.js");
const long_subtraction = require("./long_subtraction.js");
const max = require("./max.js");
const mean = require("./mean.js");
const min = require("./min.js");
const multiply = require("./multiply.js");
const multiply_array = require("./multiply_array.js");
const multiply_range = require("./multiply_range.js");
const nilakantha = require("./nilakantha.js");
const ols = require("./ols.js");
const pow = require("./pow.js");
const pow_positive = require("./pow_positive.js");
const primes = require("./primes.js");
const reciprocal = require("./reciprocal.js");
const remainder = require("./remainder.js");
const root = require("./root.js");
const root_integer_digits = require("./root_integer_digits.js");
const round = require("./round.js");
const round_last_decimal = require("./round_last_decimal.js");
const sign = require("./sign.js");
const sign_nonzero = require("./sign_nonzero.js");
const simplify_fraction = require("./simplify_fraction.js");
const sine_radians = require("./sine_radians.js");
const softmax = require("./softmax.js");
const sort = require("./sort.js");
const square = require("./square.js");
const square_root = require("./square_root.js");
const subtract = require("./subtract.js");
const sum = require("./sum.js");
const truncate = require("./truncate.js");

const module_exports = {
  absolute,
  add,
  binomial_coefficient,
  ceil,
  clean,
  compare,
  compare_positive,
  constants,
  cosine_radians,
  count_decimal_digits,
  count_integer_digits,
  cube,
  cube_root,
  divide,
  eulers_number,
  exp,
  expand,
  factorial,
  floor,
  fraction,
  // gregory_leibniz,
  hypotenuse,
  is_infinity,
  is_integer,
  is_factorial,
  is_negative_infinity,
  is_positive_infinity,
  is_zero,
  long_addition,
  long_division,
  long_multiplication,
  long_subtraction,
  mean,
  max,
  min,
  multiply,
  multiply_array,
  multiply_range,
  nilakantha,
  ols,
  pow,
  pow_positive,
  primes,
  reciprocal,
  remainder,
  root,
  root_integer_digits,
  round,
  round_last_decimal,
  sign,
  sign_nonzero,
  simplify_fraction,
  sine_radians,
  softmax,
  sort,
  square,
  square_root,
  subtract,
  sum,
  truncate
};

if (typeof define === "function" && define.amd)
  define(function () {
    return module_exports;
  });
if (typeof module === "object") {
  module.exports = module_exports;
  module.exports.default = module_exports;
}
if (typeof window === "object") window.preciso = module_exports;
if (typeof self === "object") self.preciso = module_exports;

},{"./absolute.js":1,"./add.js":2,"./binomial_coefficient.js":3,"./ceil.js":4,"./clean.js":5,"./compare.js":6,"./compare_positive.js":7,"./constants/index.js":8,"./cosine_radians.js":12,"./count_decimal_digits.js":13,"./count_integer_digits.js":14,"./cube.js":15,"./cube_root.js":16,"./divide.js":17,"./eulers_number.js":18,"./exp.js":19,"./expand.js":20,"./factorial.js":21,"./floor.js":22,"./fraction.js":23,"./hypotenuse.js":24,"./is_factorial.js":26,"./is_infinity.js":29,"./is_integer.js":30,"./is_negative_infinity.js":32,"./is_positive_infinity.js":34,"./is_zero.js":35,"./long_addition.js":36,"./long_division.js":37,"./long_multiplication.js":38,"./long_subtraction.js":39,"./max.js":40,"./mean.js":41,"./min.js":42,"./multiply.js":43,"./multiply_array.js":44,"./multiply_range.js":45,"./nilakantha.js":47,"./ols.js":48,"./pow.js":50,"./pow_positive.js":51,"./primes.js":53,"./reciprocal.js":54,"./remainder.js":55,"./root.js":56,"./root_integer_digits.js":57,"./round.js":58,"./round_last_decimal.js":59,"./sign.js":61,"./sign_nonzero.js":62,"./simplify_fraction.js":63,"./sine_radians.js":64,"./softmax.js":65,"./sort.js":66,"./square.js":67,"./square_root.js":68,"./subtract.js":69,"./sum.js":70,"./truncate.js":71}],53:[function(require,module,exports){
"use strict";

const compare_positive = require("./compare_positive.js");
const divide = require("./divide.js");
const is_integer = require("./is_integer.js");
const long_addition = require("./long_addition.js");

/**
 *
 * @param {String} start - numerical string
 * @param {String} end - numerical end
 * @returns {Array.<string>} primes - array of prime numbers as strings
 */
function primes(start = "0", end = "100") {
  const prime_single_digits = ["2", "3", "5", "7", "11"];
  const results = prime_single_digits.filter(n => compare_positive(n, start) !== "<" && compare_positive(n, end) !== ">");

  let num = "13";

  while (compare_positive(num, end) !== ">") {
    // don't even bother checking if ends with 5 or all one number
    if (!(/^\d+5/.test(num) || /^(\d)\1+/.test(num))) {
      if (["9", "7", "3"].every(digit => !is_integer(divide(num, digit)))) {
        results.push(num);
      }
    }
    num = long_addition(num, "2");
  }
  return results;
}

module.exports = primes;
module.exports.default = primes;

},{"./compare_positive.js":7,"./divide.js":17,"./is_integer.js":30,"./long_addition.js":36}],54:[function(require,module,exports){
"use strict";

const divide = require("./divide.js");
const is_fraction = require("./is_fraction.js");
const parse_fraction = require("./parse_fraction.js");

function reciprocal(n, { max_decimal_digits = 100, fraction = false } = {}) {
  if (is_fraction(n)) {
    const [numerator, denominator] = parse_fraction(n);
    if (fraction) {
      return denominator + "/" + numerator;
    } else {
      return divide(denominator, numerator, { max_decimal_digits });
    }
  } else {
    if (fraction) {
      return "1/" + n;
    } else {
      return divide("1", n, { max_decimal_digits });
    }
  }
}

module.exports = reciprocal;
module.exports.default = reciprocal;

},{"./divide.js":17,"./is_fraction.js":27,"./parse_fraction.js":49}],55:[function(require,module,exports){
"use strict";

const absolute = require("./absolute.js");
const clean = require("./clean.js");
const compare_positive = require("./compare_positive.js");
const long_division = require("./long_division.js");
const multiply = require("./multiply.js");
const subtract = require("./subtract.js");
const truncate = require("./truncate.js");

function remainder(dividend, divisor) {
  // console.log("\n\nremainder");
  dividend = clean(dividend);
  divisor = clean(divisor);

  const sign = dividend[0] === "-" ? "-" : "";

  dividend = absolute(dividend);
  divisor = absolute(divisor);

  const comparison = compare_positive(dividend, divisor);
  if (comparison === "=") return "0";

  // if dividend is less than the divisor, just return the dividend
  if (comparison === "<") {
    if (dividend[0] === ".") dividend = "0" + dividend;
    return sign + dividend;
  }

  // can use long_division because know that
  // dividend and divisor are positive numerical strings
  const quotient = long_division(dividend, divisor, { max_decimal_places: 0 });

  const times = truncate(quotient);

  const product = multiply(divisor, times);

  return sign + subtract(dividend, product);
}

module.exports = remainder;
module.exports.default = remainder;

},{"./absolute.js":1,"./clean.js":5,"./compare_positive.js":7,"./long_division.js":37,"./multiply.js":43,"./subtract.js":69,"./truncate.js":71}],56:[function(require,module,exports){
"use strict";

const absolute = require("./absolute.js");
const clean = require("./clean.js");
const compare_positive = require("./compare_positive.js");
const is_even = require("./is_even.js");
const is_integer = require("./is_integer.js");
const is_negative = require("./is_negative.js");
const pow_positive = require("./pow_positive.js");
const root_integer_digits = require("./root_integer_digits.js");

/**
 *
 * @param {String} radicand
 * @param {String} index
 * @param {Object} options
 * @param {Boolean} options.imaginary - imaginary numbers are supported
 * @param {Number} options.max_decimal_digits - maximum number of decimal digits allowed in the result
 * @returns {String} result
 */
function root(radicand, index, { imaginary = true, max_decimal_digits = 100 } = {}) {
  radicand = clean(radicand);
  index = clean(index);

  if (index === "1") return radicand;
  if (radicand === "1") return "1";

  if (!is_integer(index)) throw new Error("[preciso] can't find fractional roots");
  if (is_negative(index)) throw new Error("[preciso] can't find root of negative indexes");

  const rad = absolute(radicand);

  const radicand_is_negative = is_negative(radicand);
  const index_is_even = is_even(index);

  const has_imaginary = radicand_is_negative && index_is_even;
  if (has_imaginary && !imaginary) throw new Error("[preciso] root has an imaginary number");

  const out_sign = radicand_is_negative && !index_is_even ? "-" : "";

  const count_of_integer_places = root_integer_digits(rad, index);

  const digits = ["9", "8", "7", "6", "5", "4", "3", "2", "1", "0"];

  let left = "";

  for (let i = 0; i < count_of_integer_places; i++) {
    for (let ii = 0; ii < digits.length; ii++) {
      const digit = digits[ii];
      const test_start = left + digit;
      let test_base = test_start + "0".repeat(count_of_integer_places - i - 1);
      const test_res = pow_positive(test_base, index);
      const comparison = compare_positive(test_res, rad);
      if (comparison === "=") {
        if (has_imaginary) test_base += "i";
        return out_sign + test_base;
      } else if (comparison === "<") {
        left = test_start;
        break;
      }
    }
  }

  let base = left + ".";

  for (let i = 0; i < max_decimal_digits; i++) {
    let added = false;
    for (let ii = 0; ii < digits.length; ii++) {
      const digit = digits[ii];
      let test_base = base + digit;
      const test_res = pow_positive(test_base, index);
      const comparison = compare_positive(test_res, rad);
      if (comparison === "=") {
        if (has_imaginary) test_base += "i";
        return out_sign + test_base;
      } else if (comparison === "<") {
        base = test_base;
        added = true;
        break;
      }
    }
    if (!added) break;
  }

  if (has_imaginary) base += "i";

  return out_sign + base;
}

module.exports = root;
module.exports.default = root;

},{"./absolute.js":1,"./clean.js":5,"./compare_positive.js":7,"./is_even.js":25,"./is_integer.js":30,"./is_negative.js":31,"./pow_positive.js":51,"./root_integer_digits.js":57}],57:[function(require,module,exports){
"use strict";

const ceil = require("./ceil.js");
const count_integer_digits = require("./count_integer_digits");
const divide = require("./divide.js");

/**
 * @description returns the number of integer digits for a given nth root
 * @param {*} radicand
 * @param {*} index
 * @returns {String} the number of integer digits
 */
function root_integer_digits(radicand, index) {
  const digits = count_integer_digits(radicand);
  if (digits === "0") return "0";
  return ceil(divide(digits, index, { max_decimal_digits: 1 }));
}

module.exports = root_integer_digits;
module.exports.default = root_integer_digits;

},{"./ceil.js":4,"./count_integer_digits":14,"./divide.js":17}],58:[function(require,module,exports){
"use strict";

const is_imaginary = require("./is_imaginary.js");
const round_rational = require("./round_rational.js");

function round(n, { digits = 0 } = {}) {
  if (is_imaginary(n)) {
    return round_rational(n.substring(0, n.length - 1), { digits }) + "i";
  } else {
    return round_rational(n, { digits });
  }
}

module.exports = round;
module.exports.default = round;

},{"./is_imaginary.js":28,"./round_rational.js":60}],59:[function(require,module,exports){
"use strict";

const add = require("./add.js");
const truncate_decimal = require("./truncate_decimal.js");

// given n is a positive decimal number
const up = ["5", "6", "7", "8", "9"];

function round_last_decimal(n) {
  // will round up to an integer
  if (n.match(/\.9+$/)) {
    return add(truncate_decimal(n), "1");
  }

  // remove + from beginning
  if (n[0] === "+") n = n.substring(1);

  //console.log("rounding:", {n});
  const len = n.length;
  //console.log({len});
  let result = "";

  const last_char = n[n.length - 1];
  //console.log({last_char});

  if (up.includes(last_char)) {
    let i;
    for (i = len - 2; i >= 0; i--) {
      const char = n[i];
      //console.log({char});
      // skip over . or -
      if (char === "." || char === "-") continue;

      const nchar = Number(char) + 1;
      //console.log({nchar});

      if (nchar === 10) {
        result = "0" + result;
        // keep rounding up
      } else {
        result = nchar + result;
        break;
      }
    }
    //console.log({i});
    if (i > 0) result = n.substring(0, i) + result;
  } else {
    result = n.substring(0, len - 1);
  }

  if (result[result.length - 1] === ".") result = result.substring(0, result.length - 1);

  // remove trailing zeros in decimal number
  // 0.50 => 0.5
  if (result.indexOf(".") > -1) result = result.replace(/0+$/, "");

  return result;
}

module.exports = round_last_decimal;
module.exports.default = round_last_decimal;

},{"./add.js":2,"./truncate_decimal.js":72}],60:[function(require,module,exports){
"use strict";

const clean = require("./clean.js");
const count_decimal_digits = require("./count_decimal_digits.js");
const absolute = require("./absolute.js");
const is_negative = require("./is_negative.js");
const round_last_decimal = require("./round_last_decimal.js");

const UP = ["5", "6", "7", "8", "9"];

function round_rational(n, { digits = 0 } = { digits: 0 }) {
  n = clean(n);

  const orig = n;

  const sign = is_negative(n) ? "-" : "";

  // convert to positive because
  // round_last_decimal only works on positive decimals
  n = absolute(n);

  const idec = n.indexOf(".");

  // integer, already rounded
  if (idec === -1) return orig;

  // decimal, but already rounded enough
  if (count_decimal_digits(n) <= digits) return orig;

  const v = n[idec + digits + 1];

  if (UP.includes(v)) {
    const clip = n.substring(0, idec + digits + 2);
    return sign + round_last_decimal(clip);
  } else if (digits === 0) {
    return sign + n.substring(0, idec);
  } else {
    const clip = n.substring(0, idec + digits + 1);
    return sign + clip;
  }
}

module.exports = round_rational;
module.exports.default = round_rational;

},{"./absolute.js":1,"./clean.js":5,"./count_decimal_digits.js":13,"./is_negative.js":31,"./round_last_decimal.js":59}],61:[function(require,module,exports){
"use strict";

const is_zero = require("./is_zero.js");
const sign_nonzero = require("./sign_nonzero.js");

function sign(n) {
  return is_zero(n) ? "" : sign_nonzero(n);
}

module.exports = sign;
module.exports.default = sign;

},{"./is_zero.js":35,"./sign_nonzero.js":62}],62:[function(require,module,exports){
"use strict";

// assume n is not zero
function sign_nonzero(n) {
  return n[0] === "-" ? "-" : "+";
}

module.exports = sign_nonzero;
module.exports.default = sign_nonzero;

},{}],63:[function(require,module,exports){
"use strict";

const divide = require("./divide.js");
const is_even = require("./is_even.js");
const min = require("./min.js");
const primes = require("./primes.js");

function simplify_fraction(numerator, denominator) {
  // divide by prime numbers up to 1000
  const digits = primes("2", min(["1000", denominator, denominator]));

  // shave off excess zeros
  while (numerator.endsWith("0") && denominator.endsWith("0")) {
    numerator = numerator.substring(0, numerator.length - 1);
    denominator = denominator.substring(0, denominator.length - 1);
  }

  while (is_even(numerator) && is_even(denominator)) {
    numerator = divide(numerator, "2");
    denominator = divide(denominator, "2");
  }

  let proceed = true;
  while (proceed) {
    proceed = false;

    // attempt to divide numerator and denominator by the same digit
    for (let i = 0; i < digits.length; i++) {
      const digit = digits[i];
      const digit_length = digit.length;
      const max_decimal_digits = digit_length + 1;
      const numerator_divided = divide(numerator, digit, { ellipsis: true, max_decimal_digits });
      if (numerator_divided.indexOf(".") === -1) {
        const denominator_divided = divide(denominator, digit, { ellipsis: true, max_decimal_digits });
        if (denominator_divided.indexOf(".") === -1) {
          // console.log(`both "${numerator} and ${denominator} are evenly divisible by "${digit}"`);
          numerator = numerator_divided;
          denominator = denominator_divided;
          proceed = true;
          break;
        }
      }
    }
  }

  return [numerator, denominator];
}

module.exports = simplify_fraction;
module.exports.default = simplify_fraction;

},{"./divide.js":17,"./is_even.js":25,"./min.js":42,"./primes.js":53}],64:[function(require,module,exports){
"use strict";

const add = require("./add.js");
const is_zero = require("./is_zero.js");
const square = require("./square.js");
const multiply_rational = require("./multiply_rational.js");
const divide = require("./divide.js");

function sine_radians(n, { steps = 100, max_decimal_digits = 100 } = {}) {
  if (is_zero(n)) return "0";

  let sign = "-";
  let result = n;
  let imax = steps;
  let nsquare = square(n);
  let numerator = n;
  let denominator = "1";
  let f1;
  let f2 = "1";
  for (let i = 0; i < imax; i++) {
    f1 = add(f2, "1");
    f2 = add(f1, "1");

    // same as increasing the power by 2
    numerator = multiply_rational([numerator, nsquare], { max_decimal_digits });
    denominator = multiply_rational([denominator, f1, f2], { max_decimal_digits });
    const diff = divide(numerator, denominator, { max_decimal_digits });
    // console.log({ f1, f2, sign, numerator, denominator, diff });

    result = add(result, sign + diff);

    sign = sign === "-" ? "+" : "-";
  }
  return result;
}

module.exports = sine_radians;
module.exports.default = sine_radians;

},{"./add.js":2,"./divide.js":17,"./is_zero.js":35,"./multiply_rational.js":46,"./square.js":67}],65:[function(require,module,exports){
"use strict";

const divide = require("./divide.js");
const exp = require("./exp.js");
const sum = require("./sum.js");

function softmax(vector, { max_decimal_digits }) {
  vector = vector.map(n => exp(n, { max_decimal_digits }));

  const total = sum(vector);

  return vector.map(n => divide(n, total, { max_decimal_digits, ellipsis: false }));
}

module.exports = softmax;
module.exports.default = softmax;

},{"./divide.js":17,"./exp.js":19,"./sum.js":70}],66:[function(require,module,exports){
"use strict";

const compare = require("./compare");

function sort(nums, { direction = "ascending" } = { direction: "ascending" }) {
  const op = direction === "desc" || direction === "descending" ? "<" : ">";
  return nums.sort((a, b) => (compare(a, b) === op ? 1 : -1));
}

module.exports = sort;
module.exports.default = sort;

},{"./compare":6}],67:[function(require,module,exports){
"use strict";

const pow = require("./pow.js");

/**
 *
 * @param {String} base - numerical string
 * @returns {String} square as a numerical string
 */
function square(base, options) {
  return pow(base, "2", options);
}

module.exports = square;
module.exports.default = square;

},{"./pow.js":50}],68:[function(require,module,exports){
"use strict";

const root = require("./root.js");

function square_root(radicand, options) {
  return root(radicand, "2", options);
}

module.exports = square_root;
module.exports.default = square_root;

},{"./root.js":56}],69:[function(require,module,exports){
"use strict";

const clean = require("./clean");
const compare_positive = require("./compare_positive.js");
const long_addition = require("./long_addition.js");
const long_subtraction = require("./long_subtraction.js");

function subtract(a, b) {
  a = clean(a);
  b = clean(b);

  const a_is_positive = a[0] !== "-";
  const b_is_positive = b[0] !== "-";
  if (a_is_positive) {
    if (b_is_positive) {
      const comparison = compare_positive(a, b);
      if (comparison === ">") {
        return long_subtraction(a, b);
      } else if (comparison === "<") {
        return "-" + long_subtraction(b, a);
      } else {
        return "0";
      }
    } else {
      return long_addition(a, b.substring(1));
    }
  } else if (b_is_positive) {
    return "-" + long_addition(a.substring(1), b);
  } else {
    a = a.substring(1);
    b = b.substring(1);
    const comparison = compare_positive(a, b);
    if (comparison === ">") {
      return "-" + long_subtraction(a, b);
    } else if (comparison === "<") {
      return long_subtraction(b, a);
    } else {
      return "0";
    }
  }
}

module.exports = subtract;
module.exports.default = subtract;

},{"./clean":5,"./compare_positive.js":7,"./long_addition.js":36,"./long_subtraction.js":39}],70:[function(require,module,exports){
"use strict";

const add = require("./add.js");

function sum(nums) {
  let total = "0";
  // using iterator protocol
  for (let num of nums) {
    total = add(total, num);
  }
  return total;
}

module.exports = sum;
module.exports.default = sum;

},{"./add.js":2}],71:[function(require,module,exports){
"use strict";

function truncate(n) {
  const i = n.indexOf(".");
  if (i === -1) return n;
  else return n.substring(0, i);
}

module.exports = truncate;
module.exports.default = truncate;

},{}],72:[function(require,module,exports){
"use strict";

// given n is a decimal number
function truncate_decimal(n) {
  return n.substring(0, n.indexOf("."));
}

module.exports = truncate_decimal;
module.exports.default = truncate_decimal;

},{}]},{},[52]);
