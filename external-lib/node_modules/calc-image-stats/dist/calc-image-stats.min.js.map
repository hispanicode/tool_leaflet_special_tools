{
  "version": 3,
  "sources": ["../src/calc-image-stats.js"],
  "sourcesContent": ["const calcStats = require(\"calc-stats\");\nconst guessImageLayout = require(\"guess-image-layout\");\nconst xdim = require(\"xdim\");\n\nconst range = ct => new Array(ct).fill(0).map((_, i) => i);\n\n/**\n * @name calcImageStats\n * @param {Array} values - multi-dimensional array of numbers\n * @param {options} options - Options\n * @param {options} options.bands - number of bands (3 for RGB, 4 for RGBA)\n * @param {options} options.height - height of image\n * @param {options} options.precise - calculate using floating point arithmetic or precise numerical strings. default is false\n * @param {options} options.stats - array of stats to calculate. see https://github.com/danieljdufour/calc-stats#specify-calculations\n * @param {options} options.width - width of image\n * @param {options} options.layout - layout of values (using xdim layout syntax)\n */\nfunction calcImageStats(\n  values,\n  { bands, height, precise = false, stats, width, layout, ...rest } = {}\n) {\n  if (typeof values.then === \"function\") {\n    throw new Error(\n      \"[calc-image-stats] you passed in a promise as the data values.  please resolve the promise first before calling calcImageStats\"\n    );\n  }\n\n  const result = guessImageLayout({\n    bands,\n    data: values,\n    height,\n    layout,\n    width\n  });\n  bands ??= result.bands;\n  height ??= result.height;\n  layout ??= result.layout;\n  width ??= result.width;\n\n  const bandRange = range(bands);\n\n  const bandStats = bandRange.map(bandIndex => {\n    let band;\n    const options = { precise, stats, ...rest };\n    if ([\"[band][row,column]\", \"[band][column,row]\"].includes(layout)) {\n      band = values[bandIndex];\n    } else if (\n      [\"[band][row][column]\", \"[band][column][row]\"].includes(layout)\n    ) {\n      band = values[bandIndex];\n      options.chunked = true;\n    } else if (\n      bands === 1 &&\n      [\n        \"[band,row,column]\",\n        \"[row,column,band]\",\n        \"[column,band,row]\",\n        \"[column,row,band]\"\n      ].includes(layout)\n    ) {\n      band = values;\n    } else {\n      const rect = { band: [bandIndex, bandIndex] };\n      const sizes = { band: bands, column: width, row: height };\n      band = xdim.iterClip({ data: values, layout, rect, sizes });\n    }\n    return calcStats(band, options);\n  });\n\n  return { depth: bands, height, width, bands: bandStats };\n}\n\nif (typeof define === \"function\" && define.amd) {\n  define(function () {\n    return calcImageStats;\n  });\n}\n\nif (typeof module === \"object\") {\n  module.exports = calcImageStats;\n  module.exports.default = calcImageStats;\n  module.exports.calcImageStats = calcImageStats;\n}\n\nif (typeof self === \"object\") {\n  self.calcImageStats = calcImageStats;\n}\n\nif (typeof window === \"object\") {\n  self.calcImageStats = calcImageStats;\n}\n"],
  "mappings": "8iBAAA,MAAM,UAAY,QAAQ,YAAY,EAChC,iBAAmB,QAAQ,oBAAoB,EAC/C,KAAO,QAAQ,MAAM,EAErB,MAAQA,EAAAC,GAAM,IAAI,MAAMA,CAAE,EAAE,KAAK,CAAC,EAAE,IAAI,CAACC,EAAGC,IAAMA,CAAC,EAA3C,SAad,SAAS,eACPC,EACAC,EAAoE,CAAC,EACrE,CADA,IAAAC,EAAAD,EAAE,OAAAE,EAAO,OAAAC,EAAQ,QAAAC,EAAU,GAAO,MAAAC,EAAO,MAAAC,EAAO,OAAAC,CAnBlD,EAmBEN,EAA2DO,EAAAC,EAA3DR,EAA2D,CAAzD,QAAO,SAAQ,UAAiB,QAAO,QAAO,WAEhD,GAAI,OAAOF,EAAO,MAAS,WACzB,MAAM,IAAI,MACR,gIACF,EAGF,MAAMW,EAAS,iBAAiB,CAC9B,MAAAR,EACA,KAAMH,EACN,OAAAI,EACA,OAAAI,EACA,MAAAD,CACF,CAAC,EACDJ,GAAA,OAAAA,EAAUQ,EAAO,OACjBP,GAAA,OAAAA,EAAWO,EAAO,QAClBH,GAAA,OAAAA,EAAWG,EAAO,QAClBJ,GAAA,OAAAA,EAAUI,EAAO,OAIjB,MAAMC,EAFY,MAAMT,CAAK,EAED,IAAIU,GAAa,CAC3C,IAAIC,EACJ,MAAMC,EAAUC,EAAA,CAAE,QAAAX,EAAS,MAAAC,GAAUG,GACrC,GAAI,CAAC,qBAAsB,oBAAoB,EAAE,SAASD,CAAM,EAC9DM,EAAOd,EAAOa,CAAS,UAEvB,CAAC,sBAAuB,qBAAqB,EAAE,SAASL,CAAM,EAE9DM,EAAOd,EAAOa,CAAS,EACvBE,EAAQ,QAAU,WAElBZ,IAAU,GACV,CACE,oBACA,oBACA,oBACA,mBACF,EAAE,SAASK,CAAM,EAEjBM,EAAOd,MACF,CACL,MAAMiB,EAAO,CAAE,KAAM,CAACJ,EAAWA,CAAS,CAAE,EACtCK,EAAQ,CAAE,KAAMf,EAAO,OAAQI,EAAO,IAAKH,CAAO,EACxDU,EAAO,KAAK,SAAS,CAAE,KAAMd,EAAQ,OAAAQ,EAAQ,KAAAS,EAAM,MAAAC,CAAM,CAAC,CAC5D,CACA,OAAO,UAAUJ,EAAMC,CAAO,CAChC,CAAC,EAED,MAAO,CAAE,MAAOZ,EAAO,OAAAC,EAAQ,MAAAG,EAAO,MAAOK,CAAU,CACzD,CArDShB,EAAA,iCAuDL,OAAO,QAAW,YAAc,OAAO,KACzC,OAAO,UAAY,CACjB,OAAO,cACT,CAAC,EAGC,OAAO,QAAW,WACpB,OAAO,QAAU,eACjB,OAAO,QAAQ,QAAU,eACzB,OAAO,QAAQ,eAAiB,gBAG9B,OAAO,MAAS,WAClB,KAAK,eAAiB,gBAGpB,OAAO,QAAW,WACpB,KAAK,eAAiB",
  "names": ["__name", "ct", "_", "i", "values", "_a", "_b", "bands", "height", "precise", "stats", "width", "layout", "rest", "__objRest", "result", "bandStats", "bandIndex", "band", "options", "__spreadValues", "rect", "sizes"]
}
